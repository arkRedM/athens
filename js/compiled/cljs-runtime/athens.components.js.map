{"version":3,"sources":["athens/components.cljs"],"mappings":"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","names":["athens.components/todo-on-click","uid","from-str","to-str","current-block-content","athens.db/get-block","re-frame.core/dispatch","clojure.string/replace","athens.util/now-ts","athens.parse-renderer/componentx","_content","content","_uid","cljs.core.get","cljs.core/re-find","athens.components/block-embed-adjustments","athens.style.color","stylefy.core.use_style","block","cljs.core/last","cljs.core/PersistentVector","athens.db/get-block-document","block-random-uid","cljs.core/random-uuid","athens.views.blocks/block-el","com.rpl.specter.impl/compiled-transform*","info__49458__auto__","athens.components/pathcache65806","info65807","com.rpl.specter.impl/magic-precompilation","com.rpl.specter.impl/->FnInvocation","com.rpl.specter.impl/->VarUse","athens.util/rec-path","com.rpl.specter.impl/->SpecialFormUse","p1__65805#","precompiled65808","com.rpl.specter.impl/cached-path-info-precompiled","dynamic?__49459__auto__","com.rpl.specter.impl/cached-path-info-dynamic?","G__65809","cljs.core/contains?","p__65810","map__65811","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","cljs.core.assoc"],"sourcesContent":["(ns athens.components\n  (:require\n    [athens.parse-renderer :refer [componentx]]\n    [athens.views.blocks :as blocks]\n    [athens.style :refer [color OPACITIES]]\n    [athens.db :as db]\n    [athens.util :refer [now-ts]]\n    [re-frame.core :refer [dispatch]]\n    [posh.reagent :refer [posh! pull q]]\n    [reagent.core :as r]\n    [stylefy.core :as stylefy :refer [use-style]]\n    [com.rpl.specter :as s]\n    [athens.util :refer [rec-path]]))\n\n\n(defn todo-on-click\n  [uid from-str to-str]\n  (let [current-block-content (:block/string (db/get-block [:block/uid uid]))]\n    (dispatch [:transact [{:block/uid    uid\n                           :block/string (clojure.string/replace\n                                           current-block-content\n                                           from-str\n                                           to-str)\n                           :edit/time    (now-ts)}]])))\n\n\n(defmethod componentx :todo\n  [_content uid]\n  [:input {:type      \"checkbox\"\n           :checked   false\n           :on-change #(todo-on-click uid #\"\\{\\{\\[\\[TODO\\]\\]\\}\\}\" \"{{[[DONE]]}}\")}])\n\n\n(defmethod componentx :done\n  [_content uid]\n  [:input {:type      \"checkbox\"\n           :checked   true\n           :on-change #(todo-on-click uid #\"\\{\\{\\[\\[DONE\\]\\]\\}\\}\" \"{{[[TODO]]}}\")}])\n\n\n(defmethod componentx :youtube\n  [content _uid]\n  [:div.media-16-9\n   [:iframe {:src   (str \"https://www.youtube.com/embed/\" (get (re-find #\".*v=([a-zA-Z0-9_\\-]+)\" content) 1))\n             :allow \"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"}]])\n\n\n(defmethod componentx :iframe\n  [content _uid]\n  [:div.media-16-9\n   [:iframe {:src (re-find #\"http.*\" content)}]])\n\n\n(defmethod componentx :self\n  [content _uid]\n  [:button {:style {:color       \"red\"\n                    :font-family \"IBM Plex Mono\"}}\n   content])\n\n\n(def block-embed-adjustments\n  {:background (color :background-minus-2)\n   ::stylefy/manual [[:>.block-container\n                      {:margin-left \"0\"\n                       ::stylefy/manual [[:.textarea {:background \"transparent\"}]]}]]})\n\n\n(defmethod componentx :block-embed\n  [content _uid]\n  [:div.block-embed (use-style block-embed-adjustments)\n   (let [block (->> (re-find #\"\\(\\((.+)\\)\\)\" content)\n                    last (vector :block/uid) db/get-block-document)\n         block-random-uid (random-uuid)]\n     [blocks/block-el\n      (s/transform\n        (rec-path #(contains? % :block/uid))\n        (fn [{:block/keys [uid] :as block}]\n          (assoc block :block/uid (str uid \"-embed-\" block-random-uid)\n                       :block/original-uid uid))\n        block)\n      {:linked-ref false}\n      {:block-embed? true}])])\n\n\n\n"]}